# IoT Pentesting

## Summary

### Recon

1. all physical input, output, debug ports and components
2. non-physical connection - bluetooth, wifi, zigbee, web/mobile app, network services

* how:
  * datasheet, FCC database
  * external and internal inspection

### Attack Surface & Methods

1. hardware
   1. I/O ports, debug ports, storage medium
   2. debug info, modifying memory, dumping firmware/memory data, accessing shell, privilege escalation ( including physically shorting pins)
2. firmware
   1. retrieved by
      1. direct download, dumping, RE to get download URL
      2. if encrypted -> look for firmware signing key (sent over HTTP, etc)
   2. hard-code keys, sensitive info, database systems
   3. vulnerability via fuzzing and RE
   4. see [OWASP Firmware Security Testing Methodology](https://scriptingxss.gitbook.io/firmware-security-testing-methodology/)
3. web/mobile app
4. network services
   1. ssh, ftp, http
   2. message protocols:
      1. MQTT
         1. authentication optional and in clear text
         2. check if there is sensitive information, subscribe/send to all topics, clientID misconfig
         3. fuzzing
      2. CoAP
         1. check auth mechanism, DTLS may not be used
         2. fuzzing URIs
            1. Enumerate resources by GET, check PUT/POST/DELETE
5. wireless
   1. identify protocol, frequency/sample rate/modulation, channel and address
   2. sniffing and decode
   3. (bypass auth)
   4. replay-based attack/ modifying packet data

###

### Goals

1. credentials, hard-coded keys and sensitive info
2. sending unauthenticated request
3. decrypting network traffic to eavesdrop
4. sabotage/ undermine service availability
5. root access to shell
